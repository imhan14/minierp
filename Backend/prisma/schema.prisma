generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model formula_details {
  id               Int          @id @default(autoincrement())
  formula_id       Int?
  ingredient_id    Int?
  standard_quality Float?
  formulas         formulas?    @relation(fields: [formula_id], references: [id], onUpdate: NoAction, map: "fk_formuladetail_formula")
  ingredients      ingredients? @relation(fields: [ingredient_id], references: [id], onUpdate: NoAction, map: "fk_formuladetail_ingredient")
}

model formulas {
  id                    Int                 @id @default(autoincrement())
  formula_name          String?
  product_id            Int?
  is_active             Boolean?
  product_line          String?
  specification         String?             @db.VarChar(50)
  color                 String?             @db.VarChar(20)
  type_of_specification String?             @db.VarChar(20)
  created_at            DateTime?           @default(now()) @db.Timestamp(6)
  created_by            String?
  formula_details       formula_details[]
  products              products?           @relation(fields: [product_id], references: [id], onUpdate: NoAction, map: "fk_formula_product")
  production_orders     production_orders[]
}

model ingredients {
  id               Int                @id @default(autoincrement())
  ingredient_code  String             @unique(map: "unique_ingredient") @db.VarChar(20)
  ingredient_name  String?
  unit             String?            @db.VarChar(15)
  description      String?            @db.VarChar(50)
  created_at       DateTime?          @default(now()) @db.Timestamp(6)
  formula_details  formula_details[]
  material_details material_details[]
}

model material_details {
  id               Int               @id @default(autoincrement())
  material_id      Int?
  ingredient_id    Int?
  weight           Float?
  real_percent     Float?
  note_            String?
  ingredients      ingredients?      @relation(fields: [ingredient_id], references: [id], onUpdate: NoAction, map: "fk_materialdetail_ingredient")
  material_reports material_reports? @relation(fields: [material_id], references: [id], onUpdate: NoAction, map: "fk_materialdetail_material")
}

model material_reports {
  id               Int                @id @default(autoincrement())
  team_id          Int?
  report_date      DateTime?          @db.Date
  shift            String?            @db.VarChar(20)
  start_time       DateTime?          @db.Time(6)
  end_time         DateTime?          @db.Time(6)
  extral_materials Json?              @default("[]")
  foreman_check    Boolean?
  material_details material_details[]
  teams            teams?             @relation(fields: [team_id], references: [team_id], onUpdate: NoAction, map: "fk_material_team")
}

model product_reports {
  id                Int                @id @default(autoincrement())
  report_date       DateTime?          @db.Date
  team_id           Int?
  furnace           Int?
  shift             String?            @db.VarChar(20)
  start_time        DateTime?          @db.Time(6)
  end_time          DateTime?          @db.Time(6)
  warehouse_check   Boolean?
  producttion_check Boolean?
  teams             teams?             @relation(fields: [team_id], references: [team_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_productreport_team")
  reports_products  reports_products[]
}

model production_logs {
  id                   Int       @id @default(autoincrement())
  log_date             DateTime? @db.Date
  log_start            DateTime? @db.Time(6)
  log_end              DateTime? @db.Time(6)
  number_of_employee   Int?
  on_work              Int?
  unauthorized_absence String?
  authorized_absence   String?
  HT_di                String?
  HT_den               String?
  forklift             String?
  shift_leader         String?
  team_id              Int?
  electric             Int?
  extral_logs          Json?     @default("[]")
  teams                teams?    @relation(fields: [team_id], references: [team_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_productlogs_teams")
}

model production_orders {
  id                  Int          @id @default(autoincrement())
  order_date          DateTime?    @db.Date
  formula_id          Int?
  team_id             Int?
  product_shift       shift_type?
  target_quantity     Float?
  urea_rate           Float?
  status              status_type? @default(pending)
  input_temprature_1  Int?
  output_temprature_1 Int?
  input_temprature_2  Int?
  output_temprature_2 Int?
  order_note          String?
  created_at          DateTime?    @default(now()) @db.Timestamp(6)
  created_by          String?
  formulas            formulas?    @relation(fields: [formula_id], references: [id], onUpdate: NoAction, map: "fk_order_formula")
  teams               teams?       @relation(fields: [team_id], references: [team_id], onUpdate: NoAction, map: "fk_order_team")
}

model products {
  id               Int                @id @default(autoincrement())
  product_code     String             @unique(map: "unique_product") @db.VarChar(20)
  product_name     String?
  unit             String?            @db.VarChar(50)
  description      String?
  created_at       DateTime?          @default(now()) @db.Timestamp(6)
  formulas         formulas[]
  reports_products reports_products[]
}

model reports_products {
  id                    Int              @id @default(autoincrement())
  product_id            Int?
  report_id             Int?
  weight_               Float?
  is_finish             Boolean?
  type_of_specification String?          @db.Char(1)
  product_line          String?
  specification         String?
  start_time            DateTime?        @db.Time(6)
  end_time              DateTime?        @db.Time(6)
  note_                 String?
  products              products?        @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_reportproduct_products")
  product_reports       product_reports? @relation(fields: [report_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_reportproduct_report")
}

model roles {
  role_id        Int       @id @default(autoincrement())
  role_name      String?   @db.VarChar(50)
  priority_level Int
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  users          users[]
}

model teams {
  team_id           Int                 @id @default(autoincrement())
  team_name         String?             @db.VarChar(50)
  leader_id         Int?
  material_reports  material_reports[]
  product_reports   product_reports[]
  production_logs   production_logs[]
  production_orders production_orders[]
  users             users?              @relation(fields: [leader_id], references: [id], onUpdate: NoAction, map: "fk_team_user")
}

model users {
  id            Int       @id @default(autoincrement())
  username      String    @unique(map: "unique_username")
  password_hash String
  full_name     String?   @db.VarChar(100)
  role_id       Int?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  is_active     Boolean?
  teams         teams[]
  roles         roles?    @relation(fields: [role_id], references: [role_id], onUpdate: NoAction, map: "fk_user_role")
}

enum shift_type {
  s1x8  @map("1x8")
  s1x12 @map("1x12")
  s2x8  @map("2x8")
  s2x12 @map("2x12")
  s3x8  @map("3x8")
}

enum status_type {
  pending
  sent
  cancelled
}
